openapi: 3.1.0
x-stoplight:
  id: bv8z7mj7mwxvx
info:
  title: file-browser-api
  version: '1.0'
  contact:
    name: Collecthor B.V.
    url: 'http://collecthor.nl'
    email: info@collecthor.nl
  description: The spec that a simple file browser backend must implement
servers:
  - url: 'http://localhost:3000'
paths:
  /view:
    post:
      summary: View
      operationId: post-view
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: ./models/file.json
              examples:
                Example 1:
                  value:
                    - filename: readme.md
                      type: file
                      path: /readme.md
                      size: 150
                      mimetype: text/markdown
                      permissions:
                        read: true
                        write: true
                        create: false
                        delete: true
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: View all files(and folders) in a path
      requestBody:
        content:
          application/json:
            schema:
              type: object
              x-examples:
                example-1:
                  path: /
              properties:
                path:
                  $ref: '#/components/schemas/path'
              required:
                - path
            examples:
              Root directory:
                value:
                  path: /
              Nested:
                value:
                  path: /some/nested/directory
          application/javascript:
            schema:
              type: object
              properties: {}
        description: ''
      parameters: []
      tags:
        - file-browser
  /download:
    post:
      summary: Download
      operationId: post-download
      responses:
        '200':
          description: OK
          content:
            application/markdown:
              schema:
                type: string
                readOnly: true
              examples:
                File in root:
                  value: 'Hello, this is the readme of this project'
            application/json:
              schema:
                type: object
              examples:
                Example:
                  value:
                    test: Object
            text/plain:
              schema:
                type: string
              examples:
                String:
                  value: string
            application/octet-stream:
              schema: {}
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot download file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Download a file from the remote
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                path:
                  type: string
              required:
                - path
            examples:
              File in root:
                value:
                  path: /readme.md
              File in nested dir:
                value:
                  path: /some/nested/file.txt
        description: 'The path you want to download, can only be a file'
      tags:
        - file-browser
  /create:
    post:
      summary: Create
      operationId: post-create
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: ./models/file.json
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
                File too large:
                  value:
                    errors:
                      - status: '400'
                        title: File too large
                        detail: File was too large to be created or path is full
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Create a file or folder at the specified path
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                path:
                  $ref: ./models/path.json
                name:
                  type: string
                type:
                  type: string
                  enum:
                    - file
                    - folder
                content:
                  type: string
                  description: A data-URI of the content of the file
              required:
                - path
                - name
                - type
        description: Create a file or folder on the filesystem
      tags:
        - file-browser
  /delete:
    post:
      summary: Delete file
      operationId: post-delete
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Delete a file or folder from the filesystem
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                path:
                  $ref: '#/components/schemas/path'
              required:
                - path
            examples:
              Example 1:
                value:
                  path: /test
      tags:
        - file-browser
  /move:
    post:
      summary: Move file
      operationId: post-move
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: ./models/file.json
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Move a file on the filesystem
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                source:
                  $ref: '#/components/schemas/path'
                destination:
                  $ref: '#/components/schemas/path'
              required:
                - source
                - destination
        description: ''
      tags:
        - file-browser
  /copy:
    post:
      summary: Copy file
      operationId: post-copy
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: ./models/file.json
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Move a file on the filesystem
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                source:
                  $ref: ./models/path.json
                destination:
                  $ref: ./models/path.json
              required:
                - source
                - destination
        description: ''
      tags:
        - file-browser
    parameters: []
components:
  schemas:
    error:
      title: error
      x-stoplight:
        id: 3j6j4pcc6jqcz
      type: object
      description: 'An error which complies with https://jsonapi.org/format/#errors.'
      x-examples:
        Path not found:
          status: '400'
          title: Path not found
          detail: Could not find given path on server
        Illegal characters in filename:
          status: '422'
          title: Illegal characters in filename
          detail: Server could not process character ë in filename
        No permission:
          status: '400'
          title: No permission
          detail: 'Cannot view file/path, current user has no permission.'
      properties:
        status:
          type: string
        title:
          type: string
        detail:
          type: string
        code:
          type: string
          default: '0'
      required:
        - status
        - title
        - detail
        - code
    path:
      title: path
      x-stoplight:
        id: 6rq8gi5v2mpm8
      type: string
      description: |-
        A file path fully identifies a file. The directory separator is / and is part of a file path.
        The path MUST NOT start or end with a directory separator.
      x-examples:
        Example 1: file/abc
      pattern: ^/.*$
      minLength: 1
    filename:
      title: filename
      x-stoplight:
        id: uqzurb56y197k
      type: string
      pattern: '[^/]'
      minLength: 1
    size:
      title: size
      x-stoplight:
        id: 596yia55vrav6
      type: integer
      minimum: 0
      description: File size in bytes
    icon:
      title: icon
      x-stoplight:
        id: d97yavndec17m
      type: string
    test:
      title: test
      x-stoplight:
        id: d527osrwokcos
      type: object
      properties:
        id:
          type: string
tags:
  - name: file-browser
