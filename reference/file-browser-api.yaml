openapi: 3.0.0
x-stoplight:
  id: bv8z7mj7mwxvx
info:
  title: file-browser-api
  version: '1.0'
  contact:
    name: Collecthor B.V.
    url: 'http://collecthor.nl'
    email: info@collecthor.nl
  description: The spec that a simple file browser backend must implement
servers:
  - url: 'http://localhost:3000'
paths:
  /view:
    post:
      summary: View
      operationId: post-view
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/file'
              examples: {}
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: View all files(and folders) in a path
      requestBody:
        content:
          application/json:
            schema:
              type: object
              x-examples:
                example-1:
                  path: /
              properties:
                path:
                  type: string
              required:
                - path
            examples:
              Root directory:
                value:
                  path: /
              Nested:
                value:
                  path: /some/nested/directory
          application/javascript:
            schema:
              type: object
              properties: {}
        description: ''
      parameters: []
      tags:
        - file-browser
  /download:
    post:
      summary: Download
      operationId: post-download
      responses:
        '200':
          description: OK
          content:
            application/markdown:
              schema:
                type: string
                readOnly: true
              examples:
                File in root:
                  value: 'Hello, this is the readme of this project'
            application/json:
              schema:
                type: object
              examples:
                Example:
                  value:
                    test: Object
            text/plain:
              schema:
                type: string
              examples:
                String:
                  value: string
            application/octet-stream:
              schema: {}
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot download file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Download a file from the remote
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                path:
                  type: string
              required:
                - path
            examples:
              File in root:
                value:
                  path: /readme.md
              File in nested dir:
                value:
                  path: /some/nested/file.txt
        description: 'The path you want to download, can only be a file'
      tags:
        - file-browser
  /create:
    post:
      summary: Create
      operationId: post-create
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/file'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
                File too large:
                  value:
                    errors:
                      - status: '400'
                        title: File too large
                        detail: File was too large to be created or path is full
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Create a file or folder at the specified path
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                path:
                  type: string
                name:
                  type: string
                type:
                  type: string
                  enum:
                    - file
                    - folder
                content:
                  type: string
                  description: A data-URI of the content of the file
              required:
                - path
                - name
                - type
        description: Create a file or folder on the filesystem
      tags:
        - file-browser
  /delete:
    post:
      summary: Delete file
      operationId: post-delete
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Delete a file or folder from the filesystem
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                path:
                  type: string
              required:
                - path
      tags:
        - file-browser
  /move:
    post:
      summary: Move file
      operationId: post-move
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/file'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Move a file on the filesystem
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                source:
                  type: string
                destination:
                  type: string
              required:
                - source
                - destination
        description: ''
      tags:
        - file-browser
  /copy:
    post:
      summary: Copy file
      operationId: post-copy
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/file'
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Path not found:
                  value:
                    errors:
                      - status: '400'
                        title: Path not found
                        detail: Could not find files on given path
                        code: '0'
                Path too long:
                  value:
                    errors:
                      - status: '400'
                        title: Path too long
                        detail: 'The given path is too long. '
                        code: '0'
                No permission:
                  value:
                    errors:
                      - status: '400'
                        title: No permission
                        detail: 'Cannot view file/path, current user has no permission.'
                        code: '0'
        '422':
          description: Unprocessable Entity (WebDAV)
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Illegal characters in filename:
                  value:
                    errors:
                      - status: '422'
                        title: Illegal characters in filename
                        detail: Server could not process character ë in filename
                        code: '0'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: array
                    items:
                      $ref: '#/components/schemas/error'
              examples:
                Could not get path contents:
                  value:
                    errors:
                      - status: '500'
                        title: Could not get path contents
                        detail: The server was unable to read the path contents
                        code: '0'
                Filesystem unavailable:
                  value:
                    errors:
                      - status: '500'
                        title: Filesystem unavailable
                        detail: Error reaching the filesystem
                        code: '0'
      description: Move a file on the filesystem
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                source:
                  type: string
                destination:
                  type: string
              required:
                - source
                - destination
        description: ''
      tags:
        - file-browser
    parameters: []
components:
  schemas:
    file:
      title: file
      x-stoplight:
        id: h8jb1qxnk3eta
      type: object
      description: Any item on the file system
      examples:
        - filename: readme.md
          type: file
          path: /readme.md
          size: 150
          mimetype: text/markdown
          permissions:
            read: true
            write: true
            create: false
            delete: true
        - filename: examples
          type: folder
          path: /examples
          size: 0
          icon: path/to/custom/icon
          permissions:
            read: true
            write: false
            create: true
            delete: true
        - filename: nested.php
          type: file
          path: /some/folder/nested.php
          size: 150
          mimetype: application/x-httpd-php
          permissions:
            read: false
            write: false
            create: false
            delete: false
      properties:
        filename:
          type: string
          x-faker: system.commonFileName
        type:
          type: string
          enum:
            - file
            - folder
        path:
          type: string
          x-faker: system.directoryPath
        size:
          type: integer
          minimum: 0
          maximum: 200000
        mimetype:
          type: string
          x-faker: system.mimeType
        icon:
          type: string
          x-faker: word.noun
        permissions:
          type: object
          required:
            - read
            - write
            - create
            - delete
          properties:
            read:
              type: boolean
            write:
              type: boolean
            create:
              type: boolean
            delete:
              type: boolean
      required:
        - filename
        - type
        - path
        - size
        - permissions
    error:
      title: error
      x-stoplight:
        id: 3j6j4pcc6jqcz
      type: object
      description: 'An error which complies with https://jsonapi.org/format/#errors.'
      x-examples:
        Path not found:
          status: '400'
          title: Path not found
          detail: Could not find given path on server
        Illegal characters in filename:
          status: '422'
          title: Illegal characters in filename
          detail: Server could not process character ë in filename
        No permission:
          status: '400'
          title: No permission
          detail: 'Cannot view file/path, current user has no permission.'
      properties:
        status:
          type: string
        title:
          type: string
        detail:
          type: string
        code:
          type: string
          default: '0'
      required:
        - status
        - title
        - detail
        - code
tags:
  - name: file-browser
